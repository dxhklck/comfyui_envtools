# Python环境依赖检查器

这是一个功能强大的带图形界面的Python工具，专门用于检查第三方库的包环境与Python环境是否存在依赖冲突。它可以帮助开发者在将新项目引入已有环境时，提前发现潜在的依赖问题，避免因依赖冲突导致的项目运行异常。

## 功能特点

- **直观的可视化界面**：基于tkinter构建的用户友好图形界面，操作简单明了
- **强大的依赖解析**：支持解析requirements.txt文件中的各类依赖格式，包括：
  - 标准格式：`package==version`、`package>=version`等
  - 特殊格式：处理分号(;)后的注释内容
  - Git仓库格式：支持`git+https://github.com/user/repo.git`等格式的依赖
- **精准的冲突检查**：全面检查当前环境中已安装包与新依赖之间的版本冲突
- **安全的模拟安装**：使用pip的--dry-run模式模拟安装依赖，进一步验证兼容性
- **灵活的环境管理**：
  - 支持选择不同的Python环境进行检查和安装
  - 可查看任意Python环境中已安装的所有包
- **便捷的实际安装**：在确认无冲突后，可直接进行实际安装操作
- **界面优化**：
  - 新增清空信息按钮，方便清除之前的输出信息
  - 自定义窗口图标，提升程序辨识度

## 系统要求

- Python 3.6或更高版本
- pip已正确安装并配置
- Windows操作系统（程序已针对Windows环境优化）

## 快速开始

### 方法1：直接运行Python脚本

```bash
python environment_checker.py
```

### 方法2：使用编译好的可执行文件

直接运行`output`目录下的`environment_checker.exe`文件即可。

## 使用方法

### 基本流程

1. 运行程序后，会显示主界面
2. 默认使用当前Python环境，如需切换环境，点击"选择环境"按钮
3. 点击"选择文件"按钮，选择要检查的requirements.txt文件
4. 点击"检查环境冲突"按钮，程序会分析并显示冲突情况
5. 根据检查结果决定后续操作：
   - 如果有冲突，建议先解决冲突再进行安装
   - 如果无冲突，可选择直接进行实际安装

### 详细步骤

#### 1. 环境选择

- 点击"选择环境"按钮，可以：
  - 选择特定的Python可执行文件（.exe）
  - 选择Python环境目录（程序会自动查找其中的Python可执行文件）
- 选择后，程序会自动验证环境有效性并更新界面显示

#### 2. 文件选择

- 点击"选择文件"按钮，在文件对话框中选择requirements.txt文件
- 选择后，程序会自动解析文件中的依赖信息

#### 3. 依赖冲突检查

- 点击"检查环境冲突"按钮，程序开始检查所选环境与依赖包的兼容性
- 检查过程中，进度条会显示当前进度
- 检查完成后，结果会显示在下方的文本区域中

#### 4. 模拟安装

- 点击"模拟安装"按钮，程序使用pip的--dry-run模式模拟安装依赖
- 此操作不会实际安装任何包，仅用于进一步验证兼容性

#### 5. 查看环境

- 点击"查看当前环境"按钮，程序会显示所选Python环境中已安装的所有包
- 结果按字母顺序排序，方便查看

#### 6. 实际安装

- 当确认无冲突后，"实际安装"按钮会变为可用状态
- 点击该按钮，程序会弹出确认对话框
- 确认后，程序会开始实际安装依赖包
- 安装过程中会实时显示安装进度和输出信息

#### 7. 清空信息

- 点击"清空信息"按钮，可以快速清除结果显示区域中的所有内容
- 方便在进行多次操作时保持界面整洁

## 界面说明

程序界面主要分为以下几个区域：

- **文件选择区域**：显示当前选择的requirements.txt文件路径
- **环境选择区域**：显示当前使用的Python环境路径，包含环境选择按钮
- **功能按钮区域**：包含选择文件、检查环境冲突、模拟安装、查看当前环境、实际安装和清空信息等功能按钮
- **结果显示区域**：显示程序的运行结果和分析报告，带有滚动条
- **进度条**：在执行检查、安装等耗时操作时显示进度

## 结果解释

程序会将检查结果分为以下几类：

- **[正常]**：已安装的包满足版本要求
- **[冲突]**：已安装的包版本不满足要求，需要更新或降级
- **[未安装]**：当前环境中未安装此包，需要安装
- **[错误]**：检查过程中出现错误，可能是包名不存在或其他问题
- **[Git包]**：需要从Git仓库安装的特殊包

## 高级功能

### 支持的依赖格式

程序支持解析和处理以下格式的依赖：

- 标准版本格式：`package==1.0.0`、`package>=1.0.0`、`package<2.0.0`等
- 波浪号兼容格式：`package~=1.0.0`（表示>=1.0.0且==1.*）
- 带注释格式：`package==1.0.0; # 这是注释`（会自动忽略分号后的内容）
- Git仓库格式：`git+https://github.com/user/repo.git`（会正确识别并处理）

### 环境验证机制

当用户选择Python环境时，程序会：

1. 验证所选路径是否为有效的Python可执行文件
2. 检查该文件是否有执行权限
3. 自动更新界面显示和内部状态
4. 重置之前的检查结果和安装按钮状态

## 常见问题

### Q: 程序无法找到pip怎么办？
A: 确保你的Python环境中已正确安装pip，并且Python和pip都已添加到系统PATH中。

### Q: 检查结果出现很多冲突怎么办？
A: 建议创建一个新的虚拟环境来安装这些依赖，以避免影响现有项目。

### Q: 为什么Git格式的依赖没有进行版本检查？
A: Git格式的依赖通常是从源代码安装，没有固定的版本号，因此程序会特殊处理这类依赖。

### Q: 清空信息按钮有什么用？
A: 清空信息按钮可以清除结果显示区域中的内容，方便在进行多次操作时保持界面整洁。

## 注意事项

1. 为了获得准确的结果，建议在与目标环境相同的系统上运行此程序
2. 模拟安装功能使用`pip install --dry-run`命令，不会实际安装任何包
3. 实际安装操作会修改所选Python环境，请谨慎使用
4. 如果遇到编码问题，请确保你的requirements.txt文件使用UTF-8编码
5. 在Windows系统上，某些操作可能需要管理员权限

## 示例文件

项目中包含一个`requirements_example.txt`文件，你可以用它来测试程序的各项功能，包括标准依赖格式、带注释的依赖和Git格式的依赖。

## 开发说明

此项目使用Python标准库开发，主要依赖：
- `tkinter`：构建图形界面
- `subprocess`：调用系统命令（如pip）
- `pkg_resources`：解析和比较版本号
- 其他标准库：`os`、`sys`、`tempfile`、`threading`等

项目无需安装额外的第三方依赖，可以直接运行。